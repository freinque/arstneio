<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ArstNeio: /home/freinque/Dropbox/arst_neio/arst_neio_ng/src/arst_neio_plomp_levelt.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ArstNeio
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">arst_neio_plomp_levelt.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="arst__neio__gene_8h_source.html">arst_neio/arst_neio_gene.h</a>&quot;</code><br/>
<code>#include &lt;iostream&gt;</code><br/>
<code>#include &lt;iomanip&gt;</code><br/>
<code>#include &lt;algorithm&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;tuple&gt;</code><br/>
<code>#include &lt;gsl/gsl_vector.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_multimin.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_deriv.h&gt;</code><br/>
</div>
<p><a href="arst__neio__plomp__levelt_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2da297c061f2babb605f6d1131160a02"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arst__neio__plomp__levelt_8cpp.html#a2da297c061f2babb605f6d1131160a02">disso</a> (const <a class="el" href="struct_harmo.html">Harmo</a> &amp;h1, const <a class="el" href="struct_harmo.html">Harmo</a> &amp;h2, const <a class="el" href="struct_generic.html">Generic</a> &amp;cg)</td></tr>
<tr class="memdesc:a2da297c061f2babb605f6d1131160a02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the Plomp-Levelt dissonance of a pair of <a class="el" href="struct_harmo.html" title="Contains the information contained in a pure sine signal.">Harmo</a>.  <a href="#a2da297c061f2babb605f6d1131160a02"></a><br/></td></tr>
<tr class="memitem:a8437799121420be5fd490d78854d24d8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8437799121420be5fd490d78854d24d8"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>ddisso_df2</b> (const <a class="el" href="struct_harmo.html">Harmo</a> &amp;h1, const <a class="el" href="struct_harmo.html">Harmo</a> &amp;h2, const <a class="el" href="struct_generic.html">Generic</a> &amp;cg)</td></tr>
<tr class="memitem:a20f060fb251bff0dadd2098a5bc52040"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20f060fb251bff0dadd2098a5bc52040"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>ddisso_dr</b> (const <a class="el" href="struct_harmo.html">Harmo</a> &amp;h1, const <a class="el" href="struct_harmo.html">Harmo</a> &amp;h2, const <a class="el" href="struct_generic.html">Generic</a> &amp;cg, double r)</td></tr>
<tr class="memitem:af81b9b18560285a7f0e86b33403104ea"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arst__neio__plomp__levelt_8cpp.html#af81b9b18560285a7f0e86b33403104ea">disso</a> (const <a class="el" href="struct_pitch.html">Pitch</a> &amp;p1, const <a class="el" href="struct_pitch.html">Pitch</a> &amp;p2, const <a class="el" href="struct_generic.html">Generic</a> &amp;cg)</td></tr>
<tr class="memdesc:af81b9b18560285a7f0e86b33403104ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the Plomp-Levelt dissonance of a pair of <a class="el" href="struct_pitch.html" title="Contains a vector of Harmo.">Pitch</a> (sum on their pairs of <a class="el" href="struct_harmo.html" title="Contains the information contained in a pure sine signal.">Harmo</a>)  <a href="#af81b9b18560285a7f0e86b33403104ea"></a><br/></td></tr>
<tr class="memitem:ad6ea81373bc6ba40074d11657b336a95"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad6ea81373bc6ba40074d11657b336a95"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>ddisso_df2</b> (const <a class="el" href="struct_pitch.html">Pitch</a> &amp;p1, const <a class="el" href="struct_harmo.html">Harmo</a> &amp;h2, const <a class="el" href="struct_generic.html">Generic</a> &amp;cg)</td></tr>
<tr class="memitem:acc89296b60aa2c9a3ba097d77c168885"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arst__neio__plomp__levelt_8cpp.html#acc89296b60aa2c9a3ba097d77c168885">disso</a> (const <a class="el" href="struct_chord.html">Chord</a> &amp;c1, const <a class="el" href="struct_chord.html">Chord</a> &amp;c2, const <a class="el" href="struct_generic.html">Generic</a> &amp;cg)</td></tr>
<tr class="memdesc:acc89296b60aa2c9a3ba097d77c168885"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the Plomp-Levelt dissonance of a pair of <a class="el" href="struct_chord.html" title="Contains a vector of Pitch.">Chord</a> (sum on their pairs of <a class="el" href="struct_harmo.html" title="Contains the information contained in a pure sine signal.">Harmo</a>)  <a href="#acc89296b60aa2c9a3ba097d77c168885"></a><br/></td></tr>
<tr class="memitem:a04da9c57df9987393a3cf18c2f22fd71"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a04da9c57df9987393a3cf18c2f22fd71"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>ddisso_df2</b> (const <a class="el" href="struct_chord.html">Chord</a> &amp;c1, const <a class="el" href="struct_harmo.html">Harmo</a> &amp;h2, const <a class="el" href="struct_generic.html">Generic</a> &amp;cg)</td></tr>
<tr class="memitem:a9eec0633164c4b064c9ad688a879ebbd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arst__neio__plomp__levelt_8cpp.html#a9eec0633164c4b064c9ad688a879ebbd">disso</a> (const <a class="el" href="struct_chord_s.html">ChordS</a> &amp;t1, const <a class="el" href="struct_chord_s.html">ChordS</a> &amp;t2, const <a class="el" href="struct_generic.html">Generic</a> &amp;cg)</td></tr>
<tr class="memdesc:a9eec0633164c4b064c9ad688a879ebbd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the Plomp-Levelt dissonance of a pair of Chords (sum on their pairs of <a class="el" href="struct_harmo.html" title="Contains the information contained in a pure sine signal.">Harmo</a>)  <a href="#a9eec0633164c4b064c9ad688a879ebbd"></a><br/></td></tr>
<tr class="memitem:acaa7168e4f4f2253390556a19a5fb39a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acaa7168e4f4f2253390556a19a5fb39a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>ddisso_df2</b> (const <a class="el" href="struct_chord_s.html">ChordS</a> &amp;t1, const <a class="el" href="struct_harmo.html">Harmo</a> &amp;h2, const <a class="el" href="struct_generic.html">Generic</a> &amp;cg)</td></tr>
<tr class="memitem:ad5b8395c33f435a10ab206d67f7020ea"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arst__neio__plomp__levelt_8cpp.html#ad5b8395c33f435a10ab206d67f7020ea">disso</a> (const <a class="el" href="struct_scale.html">Scale</a> &amp;s1, const <a class="el" href="struct_scale.html">Scale</a> &amp;s2, const <a class="el" href="struct_generic.html">Generic</a> &amp;cg)</td></tr>
<tr class="memdesc:ad5b8395c33f435a10ab206d67f7020ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the Plomp-Levelt dissonance of a pair of <a class="el" href="struct_scale.html" title="Contains a equally tempered scale of n_octaves octaves, n_pitch_octaves Pitch per octave with harmo_r...">Scale</a> (sum on their pairs of <a class="el" href="struct_harmo.html" title="Contains the information contained in a pure sine signal.">Harmo</a>)  <a href="#ad5b8395c33f435a10ab206d67f7020ea"></a><br/></td></tr>
<tr class="memitem:ae14549a030553594b670abe9823857ca"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae14549a030553594b670abe9823857ca"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>ddisso_df2</b> (const <a class="el" href="struct_scale.html">Scale</a> &amp;s1, const <a class="el" href="struct_harmo.html">Harmo</a> &amp;h2, const <a class="el" href="struct_generic.html">Generic</a> &amp;cg)</td></tr>
<tr class="memitem:a87602e5cc5865f04a5d428bb77a134f8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a87602e5cc5865f04a5d428bb77a134f8"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>i_th</b> (const double x, void *params)</td></tr>
<tr class="memitem:a7e4c4ad2770a1710650f05634229ae01"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7e4c4ad2770a1710650f05634229ae01"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>gsl_numerical_gradient</b> (gsl_multimin_function *gsl_f, const gsl_vector *x_0, gsl_vector *h, gsl_vector *grad, gsl_vector *abserr)</td></tr>
<tr class="memitem:a36892508ba1485912d5d8d172ce1bf9c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a36892508ba1485912d5d8d172ce1bf9c"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>total_disso</b> (const gsl_vector *r, void *params)</td></tr>
<tr class="memitem:a9a3c09e500c1d2afa97d89237321143d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9a3c09e500c1d2afa97d89237321143d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>dtotal_disso_dr</b> (const gsl_vector *r, void *params, gsl_vector *grad)</td></tr>
<tr class="memitem:ac393c241e13501f8b5d29f4673598112"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac393c241e13501f8b5d29f4673598112"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>dtotal_disso_dr_num</b> (const gsl_vector *r, void *params, gsl_vector *grad)</td></tr>
<tr class="memitem:a95914e2682b500bec185258445a3d1ff"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a95914e2682b500bec185258445a3d1ff"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>total_disso_dtotal_disso_dr</b> (const gsl_vector *r, void *params, double *f, gsl_vector *grad)</td></tr>
<tr class="memitem:a175543303ce28854673c5fc9a4819e59"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a175543303ce28854673c5fc9a4819e59"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>total_disso_dtotal_disso_dr_num</b> (const gsl_vector *r, void *params, double *f, gsl_vector *grad)</td></tr>
<tr class="memitem:acc11899725f6c6f10d46adc3f131785a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="arst__neio__plomp__levelt_8cpp.html#acc11899725f6c6f10d46adc3f131785a">plomp_levelt</a> (const std::string &amp;o_f_n)</td></tr>
<tr class="memdesc:acc11899725f6c6f10d46adc3f131785a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Optimizes the Plompt-Levelt dissonance.  <a href="#acc11899725f6c6f10d46adc3f131785a"></a><br/></td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition in file <a class="el" href="arst__neio__plomp__levelt_8cpp_source.html">arst_neio_plomp_levelt.cpp</a>.</p>
</div><h2>Function Documentation</h2>
<a class="anchor" id="a2da297c061f2babb605f6d1131160a02"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double disso </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_harmo.html">Harmo</a> &amp;&#160;</td>
          <td class="paramname"><em>h1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_harmo.html">Harmo</a> &amp;&#160;</td>
          <td class="paramname"><em>h2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_generic.html">Generic</a> &amp;&#160;</td>
          <td class="paramname"><em>cg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the Plomp-Levelt dissonance of a pair of <a class="el" href="struct_harmo.html" title="Contains the information contained in a pure sine signal.">Harmo</a>. </p>

<p>Definition at line <a class="el" href="arst__neio__plomp__levelt_8cpp_source.html#l00014">14</a> of file <a class="el" href="arst__neio__plomp__levelt_8cpp_source.html">arst_neio_plomp_levelt.cpp</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordtype">double</span> w1 = <a class="code" href="struct_generic.html#af96840a6a414537b860c9b6754eed8ed" title="Returns the power of a db level.">Generic::power</a>(h1.<a class="code" href="struct_harmo.html#a377362b9590d312919c601e2f5feafd7" title="power in db">db</a>);</div>
<div class="line">    <span class="keywordtype">double</span> w2 = <a class="code" href="struct_generic.html#af96840a6a414537b860c9b6754eed8ed" title="Returns the power of a db level.">Generic::power</a>(h2.<a class="code" href="struct_harmo.html#a377362b9590d312919c601e2f5feafd7" title="power in db">db</a>);</div>
<div class="line">    <span class="keywordtype">double</span> w = <a class="code" href="struct_generic.html#af96840a6a414537b860c9b6754eed8ed" title="Returns the power of a db level.">Generic::power</a>(2*cg.<a class="code" href="struct_generic.html#a13053b037479ad669838b6ab8784bcea" title="db level of highest Harmo">DECI_BASE</a>);</div>
<div class="line">    <span class="keywordtype">double</span> one_over_w_times_w1_plus_w2 = 1.0/( w*(w1+w2) );</div>
<div class="line">    <span class="keywordtype">double</span> d1 = cg.<a class="code" href="struct_generic.html#a8f3f11ddb000f50a5a21937188be2793" title="Returns the distance between two Harmo in terms of cb.">dist_in_cb</a>(h1,h2);</div>
<div class="line">    <span class="keywordtype">double</span> d2 = cg.<a class="code" href="struct_generic.html#a8f3f11ddb000f50a5a21937188be2793" title="Returns the distance between two Harmo in terms of cb.">dist_in_cb</a>(h2,h1);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> cutoff = 1.0;</div>
<div class="line">    <span class="keywordtype">double</span> cutoff_dist = 0.01;</div>
<div class="line">    <span class="keywordtype">double</span> a = 1.0e5;</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> disso_out = 0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( d1 &lt; 7 ) </div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//added to kill non-zero gradients near d1=d2=0</span></div>
<div class="line">        <span class="keywordflow">if</span> ( d1&lt;cutoff_dist )</div>
<div class="line">        {</div>
<div class="line">            cutoff = 1 - exp( -a*pow(d1,2) );</div>
<div class="line">        }         </div>
<div class="line">        disso_out = cutoff * 4*w1*w2*one_over_w_times_w1_plus_w2*( w1 * d1 * exp(1-4*d1) + w2 * d2 * exp(1-4*d2) );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> disso_out;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af81b9b18560285a7f0e86b33403104ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double disso </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_pitch.html">Pitch</a> &amp;&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_pitch.html">Pitch</a> &amp;&#160;</td>
          <td class="paramname"><em>p2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_generic.html">Generic</a> &amp;&#160;</td>
          <td class="paramname"><em>cg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the Plomp-Levelt dissonance of a pair of <a class="el" href="struct_pitch.html" title="Contains a vector of Harmo.">Pitch</a> (sum on their pairs of <a class="el" href="struct_harmo.html" title="Contains the information contained in a pure sine signal.">Harmo</a>) </p>

<p>Definition at line <a class="el" href="arst__neio__plomp__levelt_8cpp_source.html#l00121">121</a> of file <a class="el" href="arst__neio__plomp__levelt_8cpp_source.html">arst_neio_plomp_levelt.cpp</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordtype">double</span> sum_disso=0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;p1.<a class="code" href="struct_pitch.html#a6a50e5dd3266fba473c40c5354d84ae6" title="The Harmo content of the Pitch.">harmo</a>.size(); i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;p2.<a class="code" href="struct_pitch.html#a6a50e5dd3266fba473c40c5354d84ae6" title="The Harmo content of the Pitch.">harmo</a>.size(); j++)</div>
<div class="line">        {</div>
<div class="line">            sum_disso = sum_disso + <a class="code" href="arst__neio__plomp__levelt_8cpp.html#a2da297c061f2babb605f6d1131160a02" title="Returns the Plomp-Levelt dissonance of a pair of Harmo.">disso</a>(p1.<a class="code" href="struct_pitch.html#a6a50e5dd3266fba473c40c5354d84ae6" title="The Harmo content of the Pitch.">harmo</a>[i],p2.<a class="code" href="struct_pitch.html#a6a50e5dd3266fba473c40c5354d84ae6" title="The Harmo content of the Pitch.">harmo</a>[j],cg);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> sum_disso;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acc89296b60aa2c9a3ba097d77c168885"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double disso </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_chord.html">Chord</a> &amp;&#160;</td>
          <td class="paramname"><em>c1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_chord.html">Chord</a> &amp;&#160;</td>
          <td class="paramname"><em>c2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_generic.html">Generic</a> &amp;&#160;</td>
          <td class="paramname"><em>cg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the Plomp-Levelt dissonance of a pair of <a class="el" href="struct_chord.html" title="Contains a vector of Pitch.">Chord</a> (sum on their pairs of <a class="el" href="struct_harmo.html" title="Contains the information contained in a pure sine signal.">Harmo</a>) </p>

<p>Definition at line <a class="el" href="arst__neio__plomp__levelt_8cpp_source.html#l00150">150</a> of file <a class="el" href="arst__neio__plomp__levelt_8cpp_source.html">arst_neio_plomp_levelt.cpp</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordtype">double</span> sum_disso=0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;c1.<a class="code" href="struct_chord.html#a79b6a6571338291187780aabcfb90d89" title="The harmo content of the Chord.">harmo</a>.size(); i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;c1.<a class="code" href="struct_chord.html#a79b6a6571338291187780aabcfb90d89" title="The harmo content of the Chord.">harmo</a>[i].size(); j++)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;c2.<a class="code" href="struct_chord.html#a79b6a6571338291187780aabcfb90d89" title="The harmo content of the Chord.">harmo</a>.size(); k++)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l=0; l&lt;c2.<a class="code" href="struct_chord.html#a79b6a6571338291187780aabcfb90d89" title="The harmo content of the Chord.">harmo</a>[k].size(); l++)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordtype">double</span> temp = <a class="code" href="arst__neio__plomp__levelt_8cpp.html#a2da297c061f2babb605f6d1131160a02" title="Returns the Plomp-Levelt dissonance of a pair of Harmo.">disso</a>(c1.<a class="code" href="struct_chord.html#a79b6a6571338291187780aabcfb90d89" title="The harmo content of the Chord.">harmo</a>[i][j],c2.<a class="code" href="struct_chord.html#a79b6a6571338291187780aabcfb90d89" title="The harmo content of the Chord.">harmo</a>[k][l],cg);</div>
<div class="line">                    sum_disso = sum_disso + temp;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> sum_disso;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9eec0633164c4b064c9ad688a879ebbd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double disso </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_chord_s.html">ChordS</a> &amp;&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_chord_s.html">ChordS</a> &amp;&#160;</td>
          <td class="paramname"><em>t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_generic.html">Generic</a> &amp;&#160;</td>
          <td class="paramname"><em>cg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the Plomp-Levelt dissonance of a pair of Chords (sum on their pairs of <a class="el" href="struct_harmo.html" title="Contains the information contained in a pure sine signal.">Harmo</a>) </p>

<p>Definition at line <a class="el" href="arst__neio__plomp__levelt_8cpp_source.html#l00189">189</a> of file <a class="el" href="arst__neio__plomp__levelt_8cpp_source.html">arst_neio_plomp_levelt.cpp</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordtype">double</span> sum_disso=0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;t1.<a class="code" href="struct_chord_s.html#a81080ea5df5146965b693be07b496cd2" title="The Harmo content of the ChordS.">harmo</a>.size(); i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;t1.<a class="code" href="struct_chord_s.html#a81080ea5df5146965b693be07b496cd2" title="The Harmo content of the ChordS.">harmo</a>[i].size(); j++)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;t1.<a class="code" href="struct_chord_s.html#a81080ea5df5146965b693be07b496cd2" title="The Harmo content of the ChordS.">harmo</a>[i][j].size(); k++) </div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l=0; l&lt;t2.<a class="code" href="struct_chord_s.html#a81080ea5df5146965b693be07b496cd2" title="The Harmo content of the ChordS.">harmo</a>.size(); l++)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=0; m&lt;t2.<a class="code" href="struct_chord_s.html#a81080ea5df5146965b693be07b496cd2" title="The Harmo content of the ChordS.">harmo</a>[l].size(); m++)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n=0; n&lt;t2.<a class="code" href="struct_chord_s.html#a81080ea5df5146965b693be07b496cd2" title="The Harmo content of the ChordS.">harmo</a>[l][m].size(); n++)</div>
<div class="line">                        {</div>
<div class="line">                            sum_disso = sum_disso + <a class="code" href="arst__neio__plomp__levelt_8cpp.html#a2da297c061f2babb605f6d1131160a02" title="Returns the Plomp-Levelt dissonance of a pair of Harmo.">disso</a>(t1.<a class="code" href="struct_chord_s.html#a81080ea5df5146965b693be07b496cd2" title="The Harmo content of the ChordS.">harmo</a>[i][j][k],t2.<a class="code" href="struct_chord_s.html#a81080ea5df5146965b693be07b496cd2" title="The Harmo content of the ChordS.">harmo</a>[l][m][n],cg);</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> sum_disso;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad5b8395c33f435a10ab206d67f7020ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double disso </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_scale.html">Scale</a> &amp;&#160;</td>
          <td class="paramname"><em>s1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_scale.html">Scale</a> &amp;&#160;</td>
          <td class="paramname"><em>s2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_generic.html">Generic</a> &amp;&#160;</td>
          <td class="paramname"><em>cg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the Plomp-Levelt dissonance of a pair of <a class="el" href="struct_scale.html" title="Contains a equally tempered scale of n_octaves octaves, n_pitch_octaves Pitch per octave with harmo_r...">Scale</a> (sum on their pairs of <a class="el" href="struct_harmo.html" title="Contains the information contained in a pure sine signal.">Harmo</a>) </p>

<p>Definition at line <a class="el" href="arst__neio__plomp__levelt_8cpp_source.html#l00236">236</a> of file <a class="el" href="arst__neio__plomp__levelt_8cpp_source.html">arst_neio_plomp_levelt.cpp</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="arst__neio__plomp__levelt_8cpp.html#a2da297c061f2babb605f6d1131160a02" title="Returns the Plomp-Levelt dissonance of a pair of Harmo.">disso</a>(s1.<a class="code" href="struct_scale.html#a70cdeef21edd17303b0b64592e40ba56" title="Returns the Scale as a Chord.">chord</a>(cg), s2.<a class="code" href="struct_scale.html#a70cdeef21edd17303b0b64592e40ba56" title="Returns the Scale as a Chord.">chord</a>(cg), cg);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acc11899725f6c6f10d46adc3f131785a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plomp_levelt </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>o_f_n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Optimizes the Plompt-Levelt dissonance. </p>

<p>Definition at line <a class="el" href="arst__neio__plomp__levelt_8cpp_source.html#l00468">468</a> of file <a class="el" href="arst__neio__plomp__levelt_8cpp_source.html">arst_neio_plomp_levelt.cpp</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> N_FR=200000;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> DB_BAS=60.0;</div>
<div class="line">    <a class="code" href="struct_generic.html" title="Contains the basic physiological functions and log/scorefile initializations.">Generic</a> gene(N_FR, DB_BAS); </div>
<div class="line"></div>
<div class="line">    gene.output_file_name = o_f_n;</div>
<div class="line"></div>
<div class="line">    std::ofstream logfile;</div>
<div class="line">    gene.logfile = &amp;logfile; </div>
<div class="line">    gene.logfile_init();</div>
<div class="line">    *gene.logfile &lt;&lt; <span class="stringliteral">&quot;logfile initiated \n&quot;</span>; <span class="comment">//&quot;f1 0 0 1 \&quot;bass_trans_cycl.wav\&quot; 0 0 0\n&quot;;</span></div>
<div class="line"></div>
<div class="line">    std::ofstream scorefile;</div>
<div class="line">    gene.scorefile = &amp;scorefile; </div>
<div class="line">    gene.scorefile_init();</div>
<div class="line">    *gene.scorefile &lt;&lt; <span class="stringliteral">&quot;f1 0 16384 10 1 0   0 0    0 0    0  \n&quot;</span>; <span class="comment">//&quot;f1 0 0 1 \&quot;bass_trans_cycl.wav\&quot; 0 0 0\n&quot;;</span></div>
<div class="line">    *gene.scorefile &lt;&lt; <span class="stringliteral">&quot;f2 0 16384 10 1 0   0 0    0 0    0  \n&quot;</span>; <span class="comment">//&quot;f2 0 0 1 \&quot;bass_trans_cycr.wav\&quot; 0 0 0\n&quot;;</span></div>
<div class="line">    *gene.scorefile &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> N_MINS=10;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> ITER_MAX=70;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> T_NET=1;</div>
<div class="line">    <span class="keywordtype">int</span> BASE_PITCH=20;</div>
<div class="line">    <span class="keywordtype">int</span> N_OCTAVE=4;</div>
<div class="line">    <span class="keywordtype">int</span> N_PITCH_OCTAVE=8;</div>
<div class="line">    <span class="keywordtype">int</span> N_HARMO_PITCH=10;</div>
<div class="line">    <span class="keywordtype">double</span> MAX_HARMO=10.0;</div>
<div class="line">    <a class="code" href="struct_score.html" title="Contains a vector of ChordS.">Score</a> score(2*N_MINS-1, 1, N_OCTAVE*N_PITCH_OCTAVE, N_HARMO_PITCH);</div>
<div class="line"></div>
<div class="line">        <span class="comment">// setting up the gsl_multimin_function to be optimized by gsl</span></div>
<div class="line">    gsl_multimin_function gsl_total_disso;</div>
<div class="line">    gsl_multimin_function* gsl_total_disso_ptr = &amp;gsl_total_disso;</div>
<div class="line">    std::tuple&lt;double, int, int, double, Generic, gsl_multimin_function*&gt; params (BASE_PITCH, N_OCTAVE, N_PITCH_OCTAVE, MAX_HARMO, gene, gsl_total_disso_ptr);</div>
<div class="line">    std::tuple&lt;double, int, int, double, Generic, gsl_multimin_function*&gt;* params_ptr = &amp;params;</div>
<div class="line">    gsl_total_disso.n = N_HARMO_PITCH-2;</div>
<div class="line">    gsl_total_disso.f = &amp;total_disso;</div>
<div class="line">    gsl_total_disso.params = (<span class="keywordtype">void</span> *) params_ptr;</div>
<div class="line"></div>
<div class="line">        <span class="comment">//declaring Nelder-Mead simplex method</span></div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">       const gsl_multimin_fminimizer_type* T = gsl_multimin_fminimizer_nmsimplex2rand;</span></div>
<div class="line"><span class="comment">       gsl_multimin_fminimizer* total_disso_minimizer =  gsl_multimin_fminimizer_alloc(T, N_HARMO_PITCH-2);</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">       gsl_total_disso.n = N_HARMO_PITCH-2;</span></div>
<div class="line"><span class="comment">       gsl_total_disso.f = &amp;total_disso;</span></div>
<div class="line"><span class="comment">       gsl_total_disso.params = (void *) params_ptr;</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">//declaring gradient descent algorithms </span></div>
<div class="line">    <span class="keyword">const</span> gsl_multimin_fdfminimizer_type* T = gsl_multimin_fdfminimizer_conjugate_fr;</div>
<div class="line">    <span class="comment">//const gsl_multimin_fdfminimizer_type* T = gsl_multimin_fdfminimizer_steepest_descent;</span></div>
<div class="line">    gsl_multimin_fdfminimizer* total_disso_minimizer =  gsl_multimin_fdfminimizer_alloc(T, N_HARMO_PITCH-2);</div>
<div class="line"></div>
<div class="line">    gsl_multimin_function_fdf gsl_total_disso_fdf;</div>
<div class="line">    gsl_multimin_function_fdf* gsl_total_disso_fdf_ptr = &amp;gsl_total_disso_fdf;  </div>
<div class="line">    gsl_total_disso_fdf.n = N_HARMO_PITCH-2;</div>
<div class="line">    gsl_total_disso_fdf.f = &amp;total_disso;</div>
<div class="line">    gsl_total_disso_fdf.df = &amp;dtotal_disso_dr;</div>
<div class="line">    gsl_total_disso_fdf.fdf = &amp;total_disso_dtotal_disso_dr;</div>
<div class="line">    <span class="comment">//gsl_total_disso_fdf.df = &amp;dtotal_disso_dr_num; //test against numerical derivatives</span></div>
<div class="line">    <span class="comment">//gsl_total_disso_fdf.fdf = &amp;total_disso_dtotal_disso_dr_num; //test against numerical derivatives</span></div>
<div class="line">    gsl_total_disso_fdf.params = (<span class="keywordtype">void</span> *) params_ptr;</div>
<div class="line">    <span class="keywordtype">double</span> step_size = 0.2;</div>
<div class="line">    <span class="keywordtype">double</span> tol = 0.1;</div>
<div class="line">    <span class="keywordtype">double</span> GRAD_NORM_MIN = 1;</div>
<div class="line"></div>
<div class="line">    std::vector&lt;std::vector&lt;double&gt;&gt; mins_list;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n=0; n&lt;N_MINS; n++)</div>
<div class="line">    {</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;------- n = &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; ---------&quot;</span> &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">            <span class="comment">//either start at a chosen set of ratios</span></div>
<div class="line">        <span class="comment">//std::vector&lt;double&gt; harmo_ratios = {1.0,3.1,3,4.1,5,6.1,8.05,8.0};</span></div>
<div class="line">        <span class="comment">//std::vector&lt;double&gt; harmo_ratios = {1,2.37841423,4,5.656854249,6.727171322,8};</span></div>
<div class="line">            <span class="comment">//or choose ratios randomly</span></div>
<div class="line">        std::vector&lt;double&gt; harmo_ratios = {1,MAX_HARMO};</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;N_HARMO_PITCH-2; i++)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">double</span> r = double(rand())/RAND_MAX;</div>
<div class="line"></div>
<div class="line">            harmo_ratios.push_back( 1 + r*(MAX_HARMO-1) );</div>
<div class="line">        } </div>
<div class="line">        sort(harmo_ratios.begin(),harmo_ratios.end());</div>
<div class="line"></div>
<div class="line">        <a class="code" href="struct_scale.html" title="Contains a equally tempered scale of n_octaves octaves, n_pitch_octaves Pitch per octave with harmo_r...">Scale</a> scale(BASE_PITCH, N_OCTAVE, N_PITCH_OCTAVE, harmo_ratios);  </div>
<div class="line">        <span class="comment">//score.harmo[0][0] = scale.chord(gene).harmo;</span></div>
<div class="line"></div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;initial disso : &quot;</span> &lt;&lt; <a class="code" href="arst__neio__plomp__levelt_8cpp.html#a2da297c061f2babb605f6d1131160a02" title="Returns the Plomp-Levelt dissonance of a pair of Harmo.">disso</a>(scale,scale,gene) &lt;&lt; endl; </div>
<div class="line">        *gene.logfile &lt;&lt; <span class="stringliteral">&quot;initial disso : &quot;</span> &lt;&lt; <a class="code" href="arst__neio__plomp__levelt_8cpp.html#a2da297c061f2babb605f6d1131160a02" title="Returns the Plomp-Levelt dissonance of a pair of Harmo.">disso</a>(scale,scale,gene) &lt;&lt; endl; </div>
<div class="line"></div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;at &quot;</span>;</div>
<div class="line">        *gene.logfile &lt;&lt; <span class="stringliteral">&quot;at &quot;</span>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; harmo_ratios.size(); i++)</div>
<div class="line">        {</div>
<div class="line">            cout &lt;&lt; harmo_ratios[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">            *gene.logfile &lt;&lt; harmo_ratios[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        cout &lt;&lt; endl;</div>
<div class="line">        *gene.logfile &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">        gsl_vector* initial_ratios = gsl_vector_alloc(N_HARMO_PITCH-2);</div>
<div class="line">        <span class="comment">//gsl_vector* initial_step = gsl_vector_alloc(N_HARMO_PITCH-2); //in case other algos</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;N_HARMO_PITCH-2; i++)</div>
<div class="line">        {</div>
<div class="line">            gsl_vector_set(initial_ratios, i, harmo_ratios[i+1]); </div>
<div class="line">            <span class="comment">//gsl_vector_set(initial_step, i, 0.03*harmo_ratios[i+1]);  //in case other algos</span></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">//gsl_multimin_fminimizer_set(total_disso_minimizer, gsl_total_disso_ptr, initial_ratios, initial_step); //in case other algos</span></div>
<div class="line">        gsl_multimin_fdfminimizer_set(total_disso_minimizer, gsl_total_disso_fdf_ptr, initial_ratios, step_size, tol);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> status;</div>
<div class="line">        <span class="keywordtype">int</span> iter=0;</div>
<div class="line">        <span class="comment">//iterations of the minimizing method</span></div>
<div class="line">        <span class="keywordflow">do</span></div>
<div class="line">        {</div>
<div class="line">            <span class="comment">//status = gsl_multimin_fminimizer_iterate(total_disso_minimizer); //in case other algos</span></div>
<div class="line">            status = gsl_multimin_fdfminimizer_iterate(total_disso_minimizer);</div>
<div class="line"></div>
<div class="line">            *gene.logfile &lt;&lt; <span class="stringliteral">&quot;after iter &quot;</span> &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot;, disso = &quot;</span> &lt;&lt; gsl_multimin_fdfminimizer_minimum(total_disso_minimizer ) &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">            std::vector&lt;double&gt; new_harmo_ratios;</div>
<div class="line">            std::vector&lt;double&gt; new_gradient;</div>
<div class="line"></div>
<div class="line">            new_harmo_ratios.push_back(1);</div>
<div class="line">            new_gradient.push_back(0);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; total_disso_minimizer-&gt;x-&gt;size; i++)</div>
<div class="line">            {</div>
<div class="line">                new_harmo_ratios.push_back( gsl_vector_get((*total_disso_minimizer).x, i) );</div>
<div class="line">                new_gradient.push_back( gsl_vector_get((*total_disso_minimizer).gradient, i) );</div>
<div class="line">            }</div>
<div class="line">            new_harmo_ratios.push_back(harmo_ratios[N_HARMO_PITCH-1]);</div>
<div class="line">            new_gradient.push_back(0);</div>
<div class="line"></div>
<div class="line">            *gene.logfile &lt;&lt; <span class="stringliteral">&quot;new ratios : &quot;</span>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; new_harmo_ratios.size(); i++)</div>
<div class="line">            {</div>
<div class="line">                *gene.logfile &lt;&lt; new_harmo_ratios[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            *gene.logfile &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">            *gene.logfile &lt;&lt; <span class="stringliteral">&quot;new -gradient : &quot;</span>; </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; new_gradient.size(); i++)</div>
<div class="line">            {</div>
<div class="line">                *gene.logfile &lt;&lt; -new_gradient[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            *gene.logfile &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">            <span class="comment">//status = gsl_multimin_test_size(size, 1e-2); //in case other algo</span></div>
<div class="line">            status = gsl_multimin_test_gradient((*total_disso_minimizer).gradient, GRAD_NORM_MIN);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span>((status == GSL_SUCCESS) || (iter==ITER_MAX) )</div>
<div class="line">            {</div>
<div class="line">                cout &lt;&lt; <span class="stringliteral">&quot;stops after iter &quot;</span> &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot;, disso = &quot;</span> &lt;&lt; gsl_multimin_fdfminimizer_minimum(total_disso_minimizer ) &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (status==GSL_SUCCESS)</div>
<div class="line">                {</div>
<div class="line">                    *gene.logfile &lt;&lt; <span class="stringliteral">&quot;minimum found\n&quot;</span>;</div>
<div class="line">                    cout &lt;&lt; <span class="stringliteral">&quot;MINIMUM FOUND\n&quot;</span>;</div>
<div class="line">                    mins_list.push_back( new_harmo_ratios );</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (iter==ITER_MAX)</div>
<div class="line">                {</div>
<div class="line">                    *gene.logfile &lt;&lt; <span class="stringliteral">&quot;max iterations reached\n&quot;</span>;</div>
<div class="line">                    cout &lt;&lt; <span class="stringliteral">&quot;max iterations reached\n&quot;</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                cout &lt;&lt; <span class="stringliteral">&quot;-gradient is : &quot;</span>; </div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; new_gradient.size(); i++)</div>
<div class="line">                {</div>
<div class="line">                    cout &lt;&lt; -new_gradient[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">                }</div>
<div class="line">                cout &lt;&lt; endl;</div>
<div class="line">                cout &lt;&lt; <span class="stringliteral">&quot;at &quot;</span>;</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; new_harmo_ratios.size(); i++)</div>
<div class="line">                {</div>
<div class="line">                    cout &lt;&lt; new_harmo_ratios[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">                }</div>
<div class="line">                cout &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">                scale.harmo_ratios = new_harmo_ratios;</div>
<div class="line">                score.harmo[2*n][0] = scale.chord(gene).harmo;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            iter++;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">while</span>(status == GSL_CONTINUE);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    *gene.logfile &lt;&lt; <span class="stringliteral">&quot;mins_list : &quot;</span>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; mins_list.size(); i++)</div>
<div class="line">    { </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; mins_list[i].size(); j++)</div>
<div class="line">        {</div>
<div class="line">            *gene.logfile &lt;&lt; mins_list[i][j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        *gene.logfile &lt;&lt; endl;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    gsl_multimin_fdfminimizer_free(total_disso_minimizer);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;score.time.size(); i++)</div>
<div class="line">    {</div>
<div class="line">        score.time[i] = 2+4*i; </div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    score.print(gene, T_NET);</div>
<div class="line">    *gene.logfile &lt;&lt; <span class="stringliteral">&quot;executed&quot;</span> &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">    (*gene.scorefile).close();</div>
<div class="line">    (*gene.logfile).close();</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jul 27 2015 17:18:38 for ArstNeio by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
